## AWS CloudTrail-Based Detections

The AWS detections in this repository are built exclusively on **AWS CloudTrail management events** and focus on identifying **control plane abuse** rather than infrastructure or network-level activity.

These detections are designed to answer a single question:

> *How can a legitimate AWS identity be abused to gain, expand, or persist access in the environment?*

---

### Detection Scope

AWS CloudTrail-based detections in this repository cover the following behavioral categories:

#### Identity and Authentication Abuse
- Anomalous STS AssumeRole activity
- Role assumption outside expected time or source baselines
- Unusual role chaining or first-time role usage
- Identity activity from previously unseen locations or networks

#### Privilege Escalation
- IAM policy attachment and modification
- Inline policy creation
- Trust relationship changes enabling broader role assumption
- Group membership changes leading to elevated permissions

#### Enumeration and Reconnaissance
- High-volume or cross-service enumeration activity
- IAM-focused discovery of roles, policies, and permissions
- Enumeration patterns deviating from normal identity behavior
- Discovery activity followed by access or role usage

#### Access Expansion and Lateral Movement
- Resource access following enumeration or role assumption
- First-time access to sensitive S3 buckets or EC2 resources
- Access patterns exceeding the typical scope of an identity

#### Persistence Mechanisms
- Creation of new IAM users or access keys
- Long-lived credential creation following suspicious activity
- Role or trust policy changes that establish durable access paths

#### Defense Evasion
- CloudTrail configuration changes
- Logging being disabled, altered, or selectively filtered
- IAM changes impacting security tooling or monitoring roles

---

### Detection Philosophy

These detections intentionally avoid alerting on isolated API calls.

Instead, they:
- Correlate multiple related actions
- Evaluate behavior relative to established baselines
- Emphasize attacker intent over individual events

This approach reduces false positives and improves detection quality in operational environments.

---

### Out of Scope

The following are intentionally excluded from AWS CloudTrail-based detections:

- Network traffic analysis (VPC Flow Logs)
- Endpoint or workload telemetry from EC2
- Raw threat intelligence or IOC matching
- Compliance or configuration-only checks

These signals are valuable, but they belong to different detection layers.

---

### Operational Considerations

Effective use of these detections assumes:
- Baseline knowledge of normal identity behavior
- Allowlists for CI/CD and infrastructure automation
- Correlation with other telemetry where available

CloudTrail-based detections are most effective when used as part of a layered detection strategy.

